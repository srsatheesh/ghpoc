{"dbEnvironment":"snowflake","version":"1.72.12","jobsTree":{"id":19704733,"name":"ROOT","children":[{"id":19704729,"name":"AAW_DIMS","children":[{"id":19704730,"name":"TransformationJobs","children":[],"jobs":[{"id":19703569,"name":"tj_Incr_Load_Dim_Account_From_PS_CUSTOMER","description":"Replumbing the BDM mapping m_Incr_Load_DIM_ACCOUNT_FROM_PS_CUSTOMER to load the DIM_ACCOUNT","type":"TRANSFORMATION","tag":"b3ade420-18fa-47a2-9b45-671f827f8ee5"}]}],"jobs":[]}],"jobs":[]},"orchestrationJobs":[],"transformationJobs":[{"id":19703569,"revision":1,"created":1724278618608,"timestamp":1724278618608,"components":{"19017408":{"id":19017408,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-48,"y":112,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[19017426],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PS_CUSTOMER"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n  \"CUST_ID\", \n  \"NAME1\",\n  \"CORPORATE_CUST_ID\"\nFROM \"${v_env_Data_Lake_DB}\".\"${v_env_PS_FS_Schema}\".\"PS_CUSTOMER\"\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017409":{"id":19017409,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":176,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[19017420],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PKG_CLIENT_ORG"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select \ncase when NAICS_glb_class_value is not null then NAICS_cust_id else a.cust_id end as cust_id,\ncase when NAICS_glb_class_value is not null then NAICS_glb_mstr_id else glb_mstr_id end as glb_mstr_id,\ncase when NAICS_glb_class_value is not null then NAICS_glb_acct_name else glb_acct_name end as glb_acct_name,\n--case when NAICS_glb_class_value is not null then NAICS_acct_class_value else acct_class_value end as acct_class_value,\ncase when NAICS_glb_class_value is not null then NAICS_glb_class_value else glb_class_value end as glb_class_value,\ncase when NAICS_glb_class_value is not null then NAICS_IS_CONGLOMERATE else CONGLOMERATE_FLG end as CONGLOMERATE_FLG,\ncase when NAICS_glb_class_value is not null then NAICS_GLB_ACCT_CREATED_DATE else GLB_ACCT_CREATED_DATE end as GLB_ACCT_CREATED_DATE,\ncase when NAICS_glb_class_value is not null then NAICS_GLB_DUNS_NUM else GLB_DUNS_NUM end as GLOBAL_CLIENT_DUNS_NUMBER\nfrom\n(SELECT PKG_CLIENT_ORG.cust_id,\nPKG_CLIENT_ORG.glb_mstr_id,\nPKG_CLIENT_ORG.glb_acct_name,\nPKG_CLIENT_ORG.acct_class_value,\nPKG_CLIENT_ORG.glb_class_value,\nPKG_CLIENT_ORG.CONGLOMERATE_FLG,\nPKG_CLIENT_ORG.GLB_ACCT_CREATED_DATE,\nPKG_CLIENT_ORG.GLB_DUNS_NUM\nFROM\n(SELECT \nA.cust_id,\nA.glb_mstr_id,\nA.glb_acct_name,\ncase when A.acct_class_code is not null /*= 'NAICS'*/ then acct_class_value else null end as acct_class_value,\ncase when A.glb_class_code is not null /*= 'NAICS'*/ then glb_class_value else null end as glb_class_value,\nROW_NUMBER() OVER (PARTITION BY A.CUST_ID ORDER BY glb_mstr_id asc , is_conglomerate asc nulls LAST)  AS ROW_NUM,\nA.IS_CONGLOMERATE AS CONGLOMERATE_FLG,\nA.glb_acct_create_date AS GLB_ACCT_CREATED_DATE,\nA.GLB_DUNS_NUM AS GLB_DUNS_NUM\nFROM \"${v_env_Data_Lake_DB}\".\"${v_env_MDM_Schema}\".PKG_CLIENT_ORG A ) PKG_CLIENT_ORG\nWHERE ROW_NUM = 1) a\nleft outer join\n(SELECT PKG_CLIENT_ORG.cust_id as NAICS_cust_id,\nPKG_CLIENT_ORG.glb_mstr_id as NAICS_glb_mstr_id,\nPKG_CLIENT_ORG.glb_acct_name as NAICS_glb_acct_name,\nPKG_CLIENT_ORG.acct_class_value as NAICS_acct_class_value,\nPKG_CLIENT_ORG.glb_class_value as NAICS_glb_class_value,\nPKG_CLIENT_ORG.CONGLOMERATE_FLG as NAICS_IS_CONGLOMERATE,\nPKG_CLIENT_ORG.GLB_ACCT_CREATED_DATE as NAICS_GLB_ACCT_CREATED_DATE,\nPKG_CLIENT_ORG.GLB_DUNS_NUM AS NAICS_GLB_DUNS_NUM\nFROM\n(SELECT \nA.cust_id,\nA.glb_mstr_id,\nA.glb_acct_name,\ncase when A.acct_class_code is not null /*= 'NAICS'*/ then acct_class_value else null end as acct_class_value,\ncase when A.glb_class_code is not null /*= 'NAICS'*/ then glb_class_value else null end as glb_class_value,\nROW_NUMBER() OVER (PARTITION BY A.CUST_ID ORDER BY glb_mstr_id asc , is_conglomerate asc nulls LAST)  AS ROW_NUM,\nA.IS_CONGLOMERATE AS CONGLOMERATE_FLG,\nA.glb_acct_create_date AS GLB_ACCT_CREATED_DATE,\nA.GLB_DUNS_NUM AS GLB_DUNS_NUM\nFROM \"${v_env_Data_Lake_DB}\".\"${v_env_MDM_Schema}\".PKG_CLIENT_ORG A where glb_class_code is not null /*= 'NAICS'*/) PKG_CLIENT_ORG\nWHERE ROW_NUM = 1) b on a.cust_id = b.NAICS_cust_id\n\n "}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017410":{"id":19017410,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":96,"y":-32,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[19017419],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PS_CUST_CREDIT"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT CUST_ID, \n       CR_LIMIT,\n       CREDIT_CLASS\n  FROM (SELECT CUST_ID, \n               CR_LIMIT,\n               CREDIT_CLASS,\n               ROW_NUMBER() OVER(PARTITION BY CUST_ID ORDER BY EFFDT DESC) RNK\n          FROM \"${v_env_Data_Lake_DB}\".\"${v_env_PS_FS_Schema}\".PS_CUST_CREDIT\n        )\n WHERE RNK = 1"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017411":{"id":19017411,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":512,"y":112,"width":32,"height":32,"inputConnectorIDs":[19017430,19017416],"outputConnectorIDs":[19017424,19017421],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DCH_Compare_Columns"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_DIM_ACCOUNT"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_NAME"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_STATUS"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_ID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_NAICS_CD"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"CORP_CUST_ID"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"CONGLOMERATE_FLG"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_TERMS_CODE"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_LIMIT_AMT"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_CLASS_CODE"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_SPECIALIST_ID"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_ANALYST_ID"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"GLB_ACCT_CREATED_DATE"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"DUNS_NUMBER"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_DUNS_NUMBER"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"COLLECTOR_ID"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"compare_ACCOUNT_LEGAL_NAME"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_ACCOUNT_STATUS"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_STATUS"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_GLOBAL_CLIENT_ID"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_ID"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_GLOBAL_CLIENT_NAME"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_GLOBAL_CLIENT_NAICS_CD"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CORP_CUST_ID"},"2":{"slot":2,"type":"STRING","value":"CORP_CUST_ID"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONGLOMERATE_FLG"},"2":{"slot":2,"type":"STRING","value":"CONGLOMERATE_FLG"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PAYMENT_TERMS_CODE"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_TERMS_CODE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CREDIT_LIMIT_AMT"},"2":{"slot":2,"type":"STRING","value":"CREDIT_LIMIT_AMT"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CREDIT_CLASS_CODE"},"2":{"slot":2,"type":"STRING","value":"CREDIT_CLASS_CODE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"compare_BILLING_SPECIALIST_ID"},"2":{"slot":2,"type":"STRING","value":"BILLING_SPECIALIST_ID"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CREDIT_ANALYST_ID"},"2":{"slot":2,"type":"STRING","value":"CREDIT_ANALYST_ID"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"master_ACCOUNT_GK"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_GK_DEL"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"compare_GLB_ACCT_CREATED_DATE"},"2":{"slot":2,"type":"STRING","value":"GLB_ACCT_CREATED_DATE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DUNS_NUMBER"},"2":{"slot":2,"type":"STRING","value":"DUNS_NUMBER"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"compare_GLOBAL_CLIENT_DUNS_NUMBER"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_DUNS_NUMBER"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"compare_ACCOUNT_NAICS_CD"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_NAICS_CD"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"compare_COLLECTOR_ID"},"2":{"slot":2,"type":"STRING","value":"COLLECTOR_ID"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017412":{"id":19017412,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":352,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[19017413],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_PS_Account_Naics_cd"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT CUST_ID,NaicsCode as ACCOUNT_NAICS_CD FROM (\nSELECT \n--DISTINCT cast(A.CUST_ID as nvarchar2(10)) as Cust_Id , cast(B.SIC_CODE as nvarchar2(10)) as NaicsCode, C.BUSINESS_UNIT as BuFilter\ncast(A.CUST_ID as nvarchar2(10)) as Cust_Id , cast(B.SIC_CODE as nvarchar2(10)) as NaicsCode,\nROW_NUMBER()OVER (PARTITION BY A.CUST_ID ORDER BY B.SIC_CODE DESC) RN\nFROM \n${v_env_Data_Lake_DB}.${v_env_PS_FS_Schema}.PS_CUSTOMER A \n,${v_env_Data_Lake_DB}.${v_env_PS_FS_Schema}.PS_CUST_SIC_CODES B \n,${v_env_Data_Lake_DB}.${v_env_PS_FS_Schema}.PS_CUSTOMER_XX C \n,${v_env_Data_Lake_DB}.${v_env_PS_FS_Schema}.PS_SIC_CODE_VW_XX D \nWHERE A.CUST_ID = B.CUST_ID AND B.SIC_CD_QUAL IN ('CAN', 'USE' , 'USP' , 'USA') \n    AND A.CUST_ID = C.CUST_ID\n    AND D.SIC_CODE = B.SIC_CODE AND D.SIC_CD_QUAL = B.SIC_CD_QUAL\n) WHERE RN=1\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017414":{"id":19017414,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":864,"y":112,"width":32,"height":32,"inputConnectorIDs":[19017417],"outputConnectorIDs":[19017423],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CAL_Add_Audit_Columns_Upsert"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP(3)"},"2":{"slot":2,"type":"STRING","value":"INSERT_DTTM"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP(3)"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_DTTM"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"'${job_name}'"},"2":{"slot":2,"type":"STRING","value":"INSERT_BY"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"'${job_name}'"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_BY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"'CLIENT'"},"2":{"slot":2,"type":"STRING","value":"RECORD_TYPE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017415":{"id":19017415,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":704,"y":112,"width":32,"height":32,"inputConnectorIDs":[19017421],"outputConnectorIDs":[19017417],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FIL_Upsert"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017440":{"id":19017440,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":1056,"y":208,"width":32,"height":32,"inputConnectorIDs":[19017427],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TGT_DIM_ACCOUNT_Soft_Deletes"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_job_Target_Table}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_job_Target_Schema}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_env_AAW_Database}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_env_Snowflake_Warehouse_X_Small}"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"target"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"input"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"ACCOUNT_ID\"=\"input\".\"ACCOUNT_ID\" AND \"target\".\"SRC_SYSTEM_NAME\"=\"input\".\"SRC_SYSTEM_NAME\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"ACCOUNT_ID\"=\"input\".\"ACCOUNT_ID\" AND \"target\".\"SRC_SYSTEM_NAME\"=\"input\".\"SRC_SYSTEM_NAME\""},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_DTTM"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_DTTM"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_BY"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_BY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DELETED_FLG"},"2":{"slot":2,"type":"STRING","value":"DELETED_FLG"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_ID"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_SYSTEM_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_STATUS"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_STATUS"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_DTTM"},"2":{"slot":2,"type":"STRING","value":"INSERT_DTTM"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_DTTM"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_DTTM"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_BY"},"2":{"slot":2,"type":"STRING","value":"INSERT_BY"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_BY"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_BY"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"RECORD_TYPE"},"2":{"slot":2,"type":"STRING","value":"RECORD_TYPE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_ID"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_ID"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAME"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"CORP_CUST_ID"},"2":{"slot":2,"type":"STRING","value":"CORP_CUST_ID"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"CONGLOMERATE_FLG"},"2":{"slot":2,"type":"STRING","value":"CONGLOMERATE_FLG"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_TERMS_CODE"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_TERMS_CODE"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_LIMIT_AMT"},"2":{"slot":2,"type":"STRING","value":"CREDIT_LIMIT_AMT"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_CLASS_CODE"},"2":{"slot":2,"type":"STRING","value":"CREDIT_CLASS_CODE"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_SPECIALIST_ID"},"2":{"slot":2,"type":"STRING","value":"BILLING_SPECIALIST_ID"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_ANALYST_ID"},"2":{"slot":2,"type":"STRING","value":"CREDIT_ANALYST_ID"}}}},"visible":false}},"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Rows Updated","mapTo":"v_job_audit_update_rowcount"},"2":{"slot":2,"fromId":null,"fromName":"Rows Inserted","mapTo":"v_job_audit_insert_rowcount"}},"expectedFailure":null,"activationStatus":"ENABLED"},"19017441":{"id":19017441,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":1056,"y":112,"width":32,"height":32,"inputConnectorIDs":[19017423],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TGT_DIM_ACCOUNT_Upsert"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_job_Target_Table}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_job_Target_Schema}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_env_AAW_Database}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_env_Snowflake_Warehouse_X_Small}"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"target"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"input"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"ACCOUNT_ID\"=\"input\".\"ACCOUNT_ID\" AND \"target\".\"SRC_SYSTEM_NAME\"=\"input\".\"SRC_SYSTEM_NAME\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"ACCOUNT_ID\"=\"input\".\"ACCOUNT_ID\" AND \"target\".\"SRC_SYSTEM_NAME\"=\"input\".\"SRC_SYSTEM_NAME\""},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_STATUS"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_STATUS"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_DTTM"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_DTTM"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_BY"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_BY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"RECORD_TYPE"},"2":{"slot":2,"type":"STRING","value":"RECORD_TYPE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_ID"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_ID"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAME"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"CORP_CUST_ID"},"2":{"slot":2,"type":"STRING","value":"CORP_CUST_ID"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"CONGLOMERATE_FLG"},"2":{"slot":2,"type":"STRING","value":"CONGLOMERATE_FLG"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_TERMS_CODE"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_TERMS_CODE"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_LIMIT_AMT"},"2":{"slot":2,"type":"STRING","value":"CREDIT_LIMIT_AMT"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_CLASS_CODE"},"2":{"slot":2,"type":"STRING","value":"CREDIT_CLASS_CODE"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_SPECIALIST_ID"},"2":{"slot":2,"type":"STRING","value":"BILLING_SPECIALIST_ID"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_ANALYST_ID"},"2":{"slot":2,"type":"STRING","value":"CREDIT_ANALYST_ID"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"GLB_ACCT_CREATED_DATE"},"2":{"slot":2,"type":"STRING","value":"GLB_ACCT_CREATED_DATE"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"DUNS_NUMBER"},"2":{"slot":2,"type":"STRING","value":"DUNS_NUMBER"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_DUNS_NUMBER"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_DUNS_NUMBER"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_NAICS_CD"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_NAICS_CD"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"COLLECTOR_ID"},"2":{"slot":2,"type":"STRING","value":"COLLECTOR_ID"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_ID"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_SYSTEM_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_STATUS"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_STATUS"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_DTTM"},"2":{"slot":2,"type":"STRING","value":"INSERT_DTTM"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_DTTM"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_DTTM"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_BY"},"2":{"slot":2,"type":"STRING","value":"INSERT_BY"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_BY"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_BY"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"RECORD_TYPE"},"2":{"slot":2,"type":"STRING","value":"RECORD_TYPE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_ID"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_ID"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAME"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"CORP_CUST_ID"},"2":{"slot":2,"type":"STRING","value":"CORP_CUST_ID"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"CONGLOMERATE_FLG"},"2":{"slot":2,"type":"STRING","value":"CONGLOMERATE_FLG"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_TERMS_CODE"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_TERMS_CODE"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_LIMIT_AMT"},"2":{"slot":2,"type":"STRING","value":"CREDIT_LIMIT_AMT"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_CLASS_CODE"},"2":{"slot":2,"type":"STRING","value":"CREDIT_CLASS_CODE"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_SPECIALIST_ID"},"2":{"slot":2,"type":"STRING","value":"BILLING_SPECIALIST_ID"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_ANALYST_ID"},"2":{"slot":2,"type":"STRING","value":"CREDIT_ANALYST_ID"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"GLB_ACCT_CREATED_DATE"},"2":{"slot":2,"type":"STRING","value":"GLB_ACCT_CREATED_DATE"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"DUNS_NUMBER"},"2":{"slot":2,"type":"STRING","value":"DUNS_NUMBER"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_DUNS_NUMBER"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_DUNS_NUMBER"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_NAICS_CD"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_NAICS_CD"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"COLLECTOR_ID"},"2":{"slot":2,"type":"STRING","value":"COLLECTOR_ID"}}}},"visible":true}},"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Rows Updated","mapTo":"v_job_audit_update_rowcount"},"2":{"slot":2,"fromId":null,"fromName":"Rows Inserted","mapTo":"v_job_audit_insert_rowcount"}},"expectedFailure":null,"activationStatus":"ENABLED"},"19017444":{"id":19017444,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":16,"y":192,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[19017422],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PS_CUST_ID_NBR"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select \n\t\"CUST_ID\", \n\tnullif(trim(\"STD_ID_NUM\"),'') as STD_ID_NUM, \n    \"STD_ID_NUM_QUAL\"\nfrom \"${v_env_Data_Lake_DB}\".\"${v_env_PS_FS_Schema}\".\"PS_CUST_ID_NBRS\"\nwhere STD_ID_NUM_QUAL = 'DN2' and SETID = 'MODEL'\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017445":{"id":19017445,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":512,"y":192,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[19017430],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_DIM_ACCOUNT"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_ACCOUNT"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_GK"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_STATUS"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_DTTM"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_DTTM"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_BY"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_MOD_BY"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"RECORD_TYPE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_ID"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_ESF_CNT"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"FORMER_ESF_CNT"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"TOTAL_ESF_CNT"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"TEK_NATIONAL_OWNER_ID"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"ACCOUNT_NAICS_CD"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"CORP_CUST_ID"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"CONGLOMERATE_FLG"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"PAYMENT_TERMS_CODE"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_LIMIT_AMT"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_CLASS_CODE"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"BILLING_SPECIALIST_ID"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"CREDIT_ANALYST_ID"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"GLB_ACCT_CREATED_DATE"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"DUNS_NUMBER"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"GLOBAL_CLIENT_DUNS_NUMBER"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"COLLECTOR_ID"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_env_AAW_EDW_Schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_env_AAW_Database}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017446":{"id":19017446,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":864,"y":208,"width":32,"height":32,"inputConnectorIDs":[19017431],"outputConnectorIDs":[19017427],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CAL_Add_Audit_Columns_Soft_Deletes"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP(3)"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_DTTM"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'${job_name}'"},"2":{"slot":2,"type":"STRING","value":"LAST_MOD_BY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"'Y'"},"2":{"slot":2,"type":"STRING","value":"DELETED_FLG"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017447":{"id":19017447,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":704,"y":208,"width":32,"height":32,"inputConnectorIDs":[19017424],"outputConnectorIDs":[19017431],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FIL_Soft_Deletes"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"D"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_SYSTEM_NAME"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"PS"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017448":{"id":19017448,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":368,"y":112,"width":32,"height":32,"inputConnectorIDs":[19017425],"outputConnectorIDs":[19017416],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CAL_Get_Join_Columns"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"ID\""},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TRIM(NVL(\"NAME\",'NAME NOT FOUND'))"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_LEGAL_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"'PS'"},"2":{"slot":2,"type":"STRING","value":"SRC_SYSTEM_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"'N/A'"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_STATUS"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"\"GLB_ROWID\""},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_ID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"\"GLB_ACCT_NAME\""},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"\"GLB_CLASS_VALUE\""},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_NAICS_CD"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"\"CONGLOMERATE_FLG\""},"2":{"slot":2,"type":"STRING","value":"CONGLOMERATE_FLG"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017449":{"id":19017449,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":16,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[19017418],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PS_CUST_OPTION"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT CUST_ID, \n       PYMNT_TERMS_CD, \n       BILLING_SPECIALIST, \n       CR_ANALYST,\n       COLLECTOR\n  FROM (SELECT CUST_ID, \n               PYMNT_TERMS_CD, \n               BILLING_SPECIALIST, \n               CR_ANALYST,\n        \t   COLLECTOR,\n               ROW_NUMBER() OVER(PARTITION BY CUST_ID ORDER BY EFFDT DESC) RNK\n          FROM \"${v_env_Data_Lake_DB}\".\"${v_env_PS_FS_Schema}\".PS_CUST_OPTION\n        )\n WHERE RNK = 1"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"19017450":{"id":19017450,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":176,"y":112,"width":32,"height":32,"inputConnectorIDs":[19017426,19017413,19017418,19017419,19017422,19017420],"outputConnectorIDs":[19017425],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JON_PS_CUSTOMER_And_PKG_CLIENT_ORG"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PS_CUSTOMER"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUSTOMER"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PKG_CLIENT_ORG"},"2":{"slot":2,"type":"STRING","value":"PKG_CLIENT_ORG"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PS_CUST_OPTION"},"2":{"slot":2,"type":"STRING","value":"PS_CUST_OPTION"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PS_CUST_CREDIT"},"2":{"slot":2,"type":"STRING","value":"PS_CUST_CREDIT"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_Source_PS_CUST_ID_NBR"},"2":{"slot":2,"type":"STRING","value":"PS_CUST_ID_NBR"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_PS_Account_Naics_cd"},"2":{"slot":2,"type":"STRING","value":"PS_ACCOUNT_NAICS_CD"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"PS_CUSTOMER\".\"CUST_ID\"=\"PKG_CLIENT_ORG\".\"CUST_ID\""},"2":{"slot":2,"type":"STRING","value":"PS_CUSTOMER_Left_PKG_CLIENT_ORG"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"PS_CUSTOMER\".\"CUST_ID\"=\"PS_CUST_OPTION\".\"CUST_ID\""},"2":{"slot":2,"type":"STRING","value":"PS_CUSTOMER_Left_PS_CUST_OPTION"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"PS_CUSTOMER\".\"CUST_ID\"=\"PS_CUST_CREDIT\".\"CUST_ID\""},"2":{"slot":2,"type":"STRING","value":"PS_CUSTOMER_Left_PS_CUST_CREDIT"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"\"PS_CUSTOMER\".\"CUST_ID\"=\"PS_CUST_ID_NBR\".\"CUST_ID\""},"2":{"slot":2,"type":"STRING","value":"PS_CUSTOMER_Left_PS_CUST_ID_NBR"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"\"PS_CUSTOMER\".\"CUST_ID\" = \"PS_ACCOUNT_NAICS_CD\".\"CUST_ID\""},"2":{"slot":2,"type":"STRING","value":"PS_CUSTOMER_Left_PS_ACCOUNT_NAICS_CD"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUSTOMER.CUST_ID"},"2":{"slot":2,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUSTOMER.NAME1"},"2":{"slot":2,"type":"STRING","value":"NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"PKG_CLIENT_ORG.GLB_MSTR_ID"},"2":{"slot":2,"type":"STRING","value":"GLB_ROWID"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PKG_CLIENT_ORG.GLB_ACCT_NAME"},"2":{"slot":2,"type":"STRING","value":"GLB_ACCT_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"PKG_CLIENT_ORG.GLB_CLASS_VALUE"},"2":{"slot":2,"type":"STRING","value":"GLB_CLASS_VALUE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUSTOMER.CORPORATE_CUST_ID"},"2":{"slot":2,"type":"STRING","value":"CORP_CUST_ID"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"PKG_CLIENT_ORG.CONGLOMERATE_FLG"},"2":{"slot":2,"type":"STRING","value":"CONGLOMERATE_FLG"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUST_OPTION.PYMNT_TERMS_CD"},"2":{"slot":2,"type":"STRING","value":"PAYMENT_TERMS_CODE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUST_CREDIT.CR_LIMIT"},"2":{"slot":2,"type":"STRING","value":"CREDIT_LIMIT_AMT"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUST_CREDIT.CREDIT_CLASS"},"2":{"slot":2,"type":"STRING","value":"CREDIT_CLASS_CODE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUST_OPTION.BILLING_SPECIALIST"},"2":{"slot":2,"type":"STRING","value":"BILLING_SPECIALIST_ID"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUST_OPTION.CR_ANALYST"},"2":{"slot":2,"type":"STRING","value":"CREDIT_ANALYST_ID"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"PS_ACCOUNT_NAICS_CD.ACCOUNT_NAICS_CD"},"2":{"slot":2,"type":"STRING","value":"ACCOUNT_NAICS_CD"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"PKG_CLIENT_ORG.GLB_ACCT_CREATED_DATE"},"2":{"slot":2,"type":"STRING","value":"GLB_ACCT_CREATED_DATE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUST_ID_NBR.STD_ID_NUM"},"2":{"slot":2,"type":"STRING","value":"DUNS_NUMBER"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"PKG_CLIENT_ORG.GLOBAL_CLIENT_DUNS_NUMBER"},"2":{"slot":2,"type":"STRING","value":"GLOBAL_CLIENT_DUNS_NUMBER"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"PS_CUST_OPTION.COLLECTOR"},"2":{"slot":2,"type":"STRING","value":"COLLECTOR_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"19017413":{"id":19017413,"sourceID":19017412,"targetID":19017450},"19017418":{"id":19017418,"sourceID":19017449,"targetID":19017450},"19017419":{"id":19017419,"sourceID":19017410,"targetID":19017450},"19017416":{"id":19017416,"sourceID":19017448,"targetID":19017411},"19017417":{"id":19017417,"sourceID":19017415,"targetID":19017414},"19017422":{"id":19017422,"sourceID":19017444,"targetID":19017450},"19017423":{"id":19017423,"sourceID":19017414,"targetID":19017441},"19017420":{"id":19017420,"sourceID":19017409,"targetID":19017450},"19017421":{"id":19017421,"sourceID":19017411,"targetID":19017415},"19017426":{"id":19017426,"sourceID":19017408,"targetID":19017450},"19017427":{"id":19017427,"sourceID":19017446,"targetID":19017440},"19017424":{"id":19017424,"sourceID":19017411,"targetID":19017447},"19017425":{"id":19017425,"sourceID":19017450,"targetID":19017448},"19017430":{"id":19017430,"sourceID":19017445,"targetID":19017411},"19017431":{"id":19017431,"sourceID":19017447,"targetID":19017446}},"canUndo":false,"undoCommand":"","undoCreated":0,"canRedo":false,"redoCommand":"","redoCreated":0,"notes":{},"noteConnectors":{},"variables":{"v_job_Target_Table":{"definition":{"name":"v_job_Target_Table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"DIM_ACCOUNT"},"v_job_Target_Schema":{"definition":{"name":"v_job_Target_Schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"AAW_EDW"},"v_job_Last_Extract_Time":{"definition":{"name":"v_job_Last_Extract_Time","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"v_job_Extract_Cutoff_Time":{"definition":{"name":"v_job_Extract_Cutoff_Time","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"v_job_audit_insert_rowcount":{"definition":{"name":"v_job_audit_insert_rowcount","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"v_job_audit_update_rowcount":{"definition":{"name":"v_job_audit_update_rowcount","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{}}],"variables":[],"environments":[]}